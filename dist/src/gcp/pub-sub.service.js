'use strict';const a47_0x3440d9=a47_0x3910;function a47_0x3910(_0x5d30da,_0x22b6bd){const _0x3017fb=a47_0x3017();return a47_0x3910=function(_0x3910dd,_0x2e97a1){_0x3910dd=_0x3910dd-0xc6;let _0x180c35=_0x3017fb[_0x3910dd];return _0x180c35;},a47_0x3910(_0x5d30da,_0x22b6bd);}function a47_0x3017(){const _0x5e19fd=['publishMessage','getMonth','__decorate','2XCCMRu','serialNo','publishEventClub','substr','projects/bepass-platform/topics/clube-palmeiras-user-entrance','from','metadata','design:paramtypes','getDate','8696dRedCU','projects/bepass-platform/topics/clube-palmeiras-user-exit','Logger','12087OjDdwC','name','function','@google-cloud/pubsub','event_subtype','convertUserIDToUUID','getSeconds','PubSub','1753686ufBzCj','publishEventGame','@sentry/node','topic','userIdFormatted','defineProperty','toString','log','getTimeStamp','Injectable','1793945nBMIhg','1342503sfHFPZ','parse','374725sfjrCm','decorate','197918ctYSXT','error','object','storageService','captureException','event_type','true','accessCode','PubSubService','stringify','./storage.service','publishEventUserExit','logger','insertString','projects/bepass-platform/topics/palmeiras-game-entrance','getFullYear','@nestjs/common','1054112XRebQI','length'];a47_0x3017=function(){return _0x5e19fd;};return a47_0x3017();}(function(_0x349c47,_0x2619f5){const _0x3798ea=a47_0x3910,_0x5f424c=_0x349c47();while(!![]){try{const _0x156904=parseInt(_0x3798ea(0xd4))/0x1+parseInt(_0x3798ea(0xec))/0x2*(parseInt(_0x3798ea(0xd2))/0x3)+parseInt(_0x3798ea(0xe7))/0x4+parseInt(_0x3798ea(0xd1))/0x5+parseInt(_0x3798ea(0xc7))/0x6+-parseInt(_0x3798ea(0xd6))/0x7+-parseInt(_0x3798ea(0xf5))/0x8*(parseInt(_0x3798ea(0xf8))/0x9);if(_0x156904===_0x2619f5)break;else _0x5f424c['push'](_0x5f424c['shift']());}catch(_0x38dfd6){_0x5f424c['push'](_0x5f424c['shift']());}}}(a47_0x3017,0x3cb85));var __decorate=this&&this[a47_0x3440d9(0xeb)]||function(_0x22a01a,_0x5422a8,_0x2545ac,_0x91e251){const _0x5851e8=a47_0x3440d9;var _0x408b7c=arguments[_0x5851e8(0xe8)],_0x20783d=_0x408b7c<0x3?_0x5422a8:_0x91e251===null?_0x91e251=Object['getOwnPropertyDescriptor'](_0x5422a8,_0x2545ac):_0x91e251,_0x17fdee;if(typeof Reflect==='object'&&typeof Reflect[_0x5851e8(0xd5)]===_0x5851e8(0xfa))_0x20783d=Reflect[_0x5851e8(0xd5)](_0x22a01a,_0x5422a8,_0x2545ac,_0x91e251);else{for(var _0x5314d7=_0x22a01a[_0x5851e8(0xe8)]-0x1;_0x5314d7>=0x0;_0x5314d7--)if(_0x17fdee=_0x22a01a[_0x5314d7])_0x20783d=(_0x408b7c<0x3?_0x17fdee(_0x20783d):_0x408b7c>0x3?_0x17fdee(_0x5422a8,_0x2545ac,_0x20783d):_0x17fdee(_0x5422a8,_0x2545ac))||_0x20783d;}return _0x408b7c>0x3&&_0x20783d&&Object['defineProperty'](_0x5422a8,_0x2545ac,_0x20783d),_0x20783d;},__metadata=this&&this['__metadata']||function(_0x3f3814,_0x3d5571){const _0x302bac=a47_0x3440d9;if(typeof Reflect===_0x302bac(0xd8)&&typeof Reflect[_0x302bac(0xf2)]==='function')return Reflect[_0x302bac(0xf2)](_0x3f3814,_0x3d5571);},PubSubService_1;Object[a47_0x3440d9(0xcc)](exports,'__esModule',{'value':!![]}),exports[a47_0x3440d9(0xde)]=void 0x0;const common_1=require(a47_0x3440d9(0xe6)),pubsub_1=require(a47_0x3440d9(0xfb)),storage_service_1=require(a47_0x3440d9(0xe0)),Sentry=require(a47_0x3440d9(0xc9));let PubSubService=PubSubService_1=class PubSubService{constructor(_0x4a3481){const _0xa7290a=a47_0x3440d9;this[_0xa7290a(0xd9)]=_0x4a3481,this['logger']=new common_1[(_0xa7290a(0xf7))](PubSubService_1[_0xa7290a(0xf9)]);}['insertString'](_0x11affa,_0x4f5e8d,_0x564733){const _0x151e3e=a47_0x3440d9;return _0x11affa[_0x151e3e(0xef)](0x0,_0x4f5e8d)+_0x564733+_0x11affa[_0x151e3e(0xef)](_0x4f5e8d);}[a47_0x3440d9(0xfd)](_0x3ecd7c){const _0x5db989=a47_0x3440d9;return _0x3ecd7c=this['insertString'](_0x3ecd7c,0x8,'-'),_0x3ecd7c=this[_0x5db989(0xe3)](_0x3ecd7c,0xd,'-'),_0x3ecd7c=this[_0x5db989(0xe3)](_0x3ecd7c,0x12,'-'),_0x3ecd7c=this[_0x5db989(0xe3)](_0x3ecd7c,0x17,'-'),_0x3ecd7c;}[a47_0x3440d9(0xcf)](){const _0x2d3be9=a47_0x3440d9,_0x5ce8d3=new Date();return''+_0x5ce8d3[_0x2d3be9(0xe5)]()+_0x5ce8d3[_0x2d3be9(0xea)]()+_0x5ce8d3[_0x2d3be9(0xf4)]()+_0x5ce8d3['getHours']()+_0x5ce8d3['getMinutes']()+_0x5ce8d3[_0x2d3be9(0xfe)]();}async[a47_0x3440d9(0xee)](_0x1cf3c3){const _0x184020=a47_0x3440d9;try{_0x1cf3c3[_0x184020(0xdb)]=_0x1cf3c3[_0x184020(0xdb)][_0x184020(0xcd)](),_0x1cf3c3[_0x184020(0xfc)]=_0x1cf3c3['event_subtype'][_0x184020(0xcd)](),_0x1cf3c3[_0x184020(0xdd)]=_0x1cf3c3['accessCode'][_0x184020(0xcd)](),_0x1cf3c3[_0x184020(0xcb)]=_0x1cf3c3[_0x184020(0xcb)]||_0x1cf3c3[_0x184020(0xdd)][_0x184020(0xcd)](),_0x1cf3c3[_0x184020(0xed)]=_0x1cf3c3[_0x184020(0xed)][_0x184020(0xcd)](),this[_0x184020(0xe2)][_0x184020(0xce)](_0x1cf3c3);const _0x52c6cd=new pubsub_1[(_0x184020(0xc6))](),_0x2c0329=await _0x52c6cd[_0x184020(0xca)](_0x184020(0xf0))[_0x184020(0xe9)]({'attributes':JSON[_0x184020(0xd3)](JSON[_0x184020(0xdf)](_0x1cf3c3)),'data':Buffer[_0x184020(0xf1)](JSON['stringify'](_0x1cf3c3)),'messageId':this[_0x184020(0xcf)](),'orderingKey':this[_0x184020(0xcf)]()});this[_0x184020(0xe2)][_0x184020(0xce)](_0x2c0329);}catch(_0x3c1284){Sentry['captureException'](_0x3c1284),this[_0x184020(0xe2)][_0x184020(0xd7)](_0x3c1284);}}async[a47_0x3440d9(0xc8)](_0x28427){const _0x54a178=a47_0x3440d9;try{this[_0x54a178(0xe2)][_0x54a178(0xce)](_0x28427),_0x28427[_0x54a178(0xdb)]=_0x28427[_0x54a178(0xdb)][_0x54a178(0xcd)](),_0x28427[_0x54a178(0xfc)]=_0x28427[_0x54a178(0xfc)]['toString'](),_0x28427['accessCode']=_0x28427[_0x54a178(0xdd)][_0x54a178(0xcd)](),_0x28427['userIdFormatted']=_0x28427['userIdFormatted']||_0x28427[_0x54a178(0xdd)][_0x54a178(0xcd)](),_0x28427['serialNo']=_0x28427[_0x54a178(0xed)]['toString']();const _0x468b5b=new pubsub_1[(_0x54a178(0xc6))](),_0x329951=await _0x468b5b[_0x54a178(0xca)](_0x54a178(0xe4))[_0x54a178(0xe9)]({'attributes':JSON['parse'](JSON[_0x54a178(0xdf)](_0x28427)),'data':Buffer[_0x54a178(0xf1)](JSON[_0x54a178(0xdf)](_0x28427)),'messageId':this[_0x54a178(0xcf)](),'orderingKey':this[_0x54a178(0xcf)]()});this[_0x54a178(0xe2)][_0x54a178(0xce)](_0x329951);}catch(_0x591255){Sentry[_0x54a178(0xda)](_0x591255),this[_0x54a178(0xe2)][_0x54a178(0xd7)](_0x591255);}}async[a47_0x3440d9(0xe1)](_0x39b02c,_0x2bcb8a,_0x59327e,_0x178a6d){const _0x60c724=a47_0x3440d9;this[_0x60c724(0xe2)][_0x60c724(0xce)]('publishEventUserExit');const _0x5ae6db=new pubsub_1[(_0x60c724(0xc6))](),_0x35ede4=await _0x5ae6db['topic'](_0x60c724(0xf6))[_0x60c724(0xe9)]({'attributes':{'userId':this[_0x60c724(0xfd)](_0x39b02c),'accessCode':_0x178a6d[_0x60c724(0xcd)](),'IP':_0x59327e,'isVisitor':_0x178a6d==='visitor'?_0x60c724(0xdc)[_0x60c724(0xcd)]():'false'[_0x60c724(0xcd)](),'timestamp':this[_0x60c724(0xcf)]()},'messageId':this[_0x60c724(0xcf)](),'orderingKey':this[_0x60c724(0xcf)]()});this[_0x60c724(0xe2)][_0x60c724(0xce)](_0x35ede4);}};PubSubService=PubSubService_1=__decorate([(0x0,common_1[a47_0x3440d9(0xd0)])(),__metadata(a47_0x3440d9(0xf3),[storage_service_1['StorageService']])],PubSubService),exports[a47_0x3440d9(0xde)]=PubSubService;