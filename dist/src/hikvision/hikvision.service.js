'use strict';function a55_0xe4fe(_0x47ed3f,_0x4dd2b7){var _0x55214a=a55_0x5521();return a55_0xe4fe=function(_0xe4fe78,_0x50feec){_0xe4fe78=_0xe4fe78-0x115;var _0x448724=_0x55214a[_0xe4fe78];return _0x448724;},a55_0xe4fe(_0x47ed3f,_0x4dd2b7);}var a55_0x442c7d=a55_0xe4fe;(function(_0x535af3,_0x3c5165){var _0x9cfc45=a55_0xe4fe,_0x27328b=_0x535af3();while(!![]){try{var _0x47e4d9=parseInt(_0x9cfc45(0x11b))/0x1+parseInt(_0x9cfc45(0x158))/0x2*(parseInt(_0x9cfc45(0x127))/0x3)+parseInt(_0x9cfc45(0x135))/0x4*(-parseInt(_0x9cfc45(0x151))/0x5)+parseInt(_0x9cfc45(0x11e))/0x6+parseInt(_0x9cfc45(0x14a))/0x7+parseInt(_0x9cfc45(0x152))/0x8*(parseInt(_0x9cfc45(0x117))/0x9)+-parseInt(_0x9cfc45(0x154))/0xa;if(_0x47e4d9===_0x3c5165)break;else _0x27328b['push'](_0x27328b['shift']());}catch(_0x1f4659){_0x27328b['push'](_0x27328b['shift']());}}}(a55_0x5521,0x6608e));var __decorate=this&&this[a55_0x442c7d(0x14c)]||function(_0x411282,_0x4ef1fd,_0x6de578,_0x24c886){var _0x215344=a55_0x442c7d,_0x2fee18=arguments[_0x215344(0x134)],_0x78cefd=_0x2fee18<0x3?_0x4ef1fd:_0x24c886===null?_0x24c886=Object[_0x215344(0x144)](_0x4ef1fd,_0x6de578):_0x24c886,_0x3222dc;if(typeof Reflect===_0x215344(0x148)&&typeof Reflect[_0x215344(0x128)]===_0x215344(0x115))_0x78cefd=Reflect[_0x215344(0x128)](_0x411282,_0x4ef1fd,_0x6de578,_0x24c886);else{for(var _0x59eb2f=_0x411282['length']-0x1;_0x59eb2f>=0x0;_0x59eb2f--)if(_0x3222dc=_0x411282[_0x59eb2f])_0x78cefd=(_0x2fee18<0x3?_0x3222dc(_0x78cefd):_0x2fee18>0x3?_0x3222dc(_0x4ef1fd,_0x6de578,_0x78cefd):_0x3222dc(_0x4ef1fd,_0x6de578))||_0x78cefd;}return _0x2fee18>0x3&&_0x78cefd&&Object[_0x215344(0x146)](_0x4ef1fd,_0x6de578,_0x78cefd),_0x78cefd;},__metadata=this&&this['__metadata']||function(_0x7a8d89,_0x2ea7e4){var _0x55884a=a55_0x442c7d;if(typeof Reflect===_0x55884a(0x148)&&typeof Reflect[_0x55884a(0x13b)]==='function')return Reflect['metadata'](_0x7a8d89,_0x2ea7e4);},HikvisionService_1;Object[a55_0x442c7d(0x146)](exports,a55_0x442c7d(0x141),{'value':!![]}),exports[a55_0x442c7d(0x125)]=void 0x0;function a55_0x5521(){var _0x2257fa=['length','116sgWiPp','debug','env','userType','XXXX','Logger','metadata','card\x20event','serialNo','deviceName','dateTime','@nestjs/common','__esModule','watch','AccessControllerEvent','getOwnPropertyDescriptor','access\x20denied','defineProperty','@nestjs/axios','object','event_type','2653350XkpUMg','true','__decorate','httpService','http://127.0.0.1/supervisor.php?codigo=invalid','event_log','websocketMessage','108200ahUKLK','8lRgQIS','isFaceRecognitionEvent','4493940pmsbrT','lastValueFrom','log','event_subtype','214nvzTdD','face','../bepass/bepass.service','function','get','6326433huRZRY','logger','admin','error','303987yPiUGJ','design:paramtypes','parseEvent','421080UOWYLx','currentVerifyMode','cardOrFace','card','cardNo','HttpService','accessCode','HikvisionService','isFaceDenyEvent','1086Vvvusk','decorate','Injectable','http://localhost/supervisor.php?codigo=','employeeNoString','isCardRecognitionEvent','BEPASS_ACCESS_CONTROL_ENABLED','name','HIKI_CREDENCIALS','ipAddress','rxjs','process','bepassService'];a55_0x5521=function(){return _0x2257fa;};return a55_0x5521();}const common_1=require(a55_0x442c7d(0x140)),process=require(a55_0x442c7d(0x132)),rxjs_1=require(a55_0x442c7d(0x131)),axios_1=require(a55_0x442c7d(0x147)),bepass_service_1=require(a55_0x442c7d(0x15a));let HikvisionService=HikvisionService_1=class HikvisionService{constructor(_0x28c9a7,_0x18100d){var _0x3ea28d=a55_0x442c7d;this['httpService']=_0x28c9a7,this[_0x3ea28d(0x133)]=_0x18100d,this['logger']=new common_1[(_0x3ea28d(0x13a))](HikvisionService_1[_0x3ea28d(0x12e)]),this[_0x3ea28d(0x12f)]={'user':_0x3ea28d(0x119),'password':'abcd1234'};}[a55_0x442c7d(0x11d)](_0x3c7b31){var _0x533ae4=a55_0x442c7d;return{'device':_0x3c7b31[_0x533ae4(0x143)][_0x533ae4(0x13e)],'terminalIP':_0x3c7b31[_0x533ae4(0x130)],'userIdFormatted':_0x3c7b31[_0x533ae4(0x143)][_0x533ae4(0x12b)],'event_type':_0x3c7b31[_0x533ae4(0x143)]['majorEventType'],'name':_0x3c7b31[_0x533ae4(0x143)]['name']||'notFound','event_subtype':_0x3c7b31['AccessControllerEvent']['subEventType'],'userType':_0x3c7b31[_0x533ae4(0x143)][_0x533ae4(0x138)],'verification_mode':_0x3c7b31[_0x533ae4(0x143)][_0x533ae4(0x11f)],'accessCode':_0x3c7b31[_0x533ae4(0x143)][_0x533ae4(0x12b)]||![],'serialNo':_0x3c7b31[_0x533ae4(0x143)][_0x533ae4(0x13d)],'dateTime':_0x3c7b31[_0x533ae4(0x13f)],'direction':'','cardOrFace':'','multiclubesStatus':'','multiclubesMessage':'','statusDescription':'','cardNo':_0x3c7b31[_0x533ae4(0x143)]['cardNo']};}async[a55_0x442c7d(0x142)](_0x47bd75){var _0x2d87cc=a55_0x442c7d;try{this[_0x2d87cc(0x118)][_0x2d87cc(0x136)](JSON['parse'](_0x47bd75[_0x2d87cc(0x14f)]));let _0x1bb503=this[_0x2d87cc(0x11d)](JSON['parse'](_0x47bd75[_0x2d87cc(0x14f)]));if(this[_0x2d87cc(0x153)](_0x1bb503))return this['logger'][_0x2d87cc(0x156)]('\x20face\x20recognized\x20user\x20type:\x20'+_0x1bb503['userType']),_0x1bb503[_0x2d87cc(0x120)]=_0x2d87cc(0x159),_0x1bb503['accessCode']?await this['bepassService'][_0x2d87cc(0x150)]({'message':{'hash':_0x1bb503[_0x2d87cc(0x124)]}}):await(0x0,rxjs_1[_0x2d87cc(0x155)])(this[_0x2d87cc(0x14d)][_0x2d87cc(0x116)](_0x2d87cc(0x12a)+(_0x1bb503['accessCode']||_0x2d87cc(0x139)))),!![];else{if(this[_0x2d87cc(0x126)](_0x1bb503)){if(process[_0x2d87cc(0x137)][_0x2d87cc(0x12d)]===_0x2d87cc(0x14b))return console[_0x2d87cc(0x156)](_0x2d87cc(0x145)),await(0x0,rxjs_1['lastValueFrom'])(this[_0x2d87cc(0x14d)]['get'](_0x2d87cc(0x14e))),!![];}else{if(this[_0x2d87cc(0x12c)](_0x1bb503))this[_0x2d87cc(0x118)]['log'](_0x2d87cc(0x13c)),this['logger'][_0x2d87cc(0x136)](_0x1bb503[_0x2d87cc(0x122)]),_0x1bb503[_0x2d87cc(0x120)]=_0x1bb503[_0x2d87cc(0x157)]===0x9?'cardNoTerminal':_0x2d87cc(0x121),_0x1bb503['cardNo']?await this[_0x2d87cc(0x133)]['websocketMessage']({'message':{'hash':_0x1bb503[_0x2d87cc(0x122)]}}):await(0x0,rxjs_1[_0x2d87cc(0x155)])(this['httpService'][_0x2d87cc(0x116)](_0x2d87cc(0x12a)+(_0x1bb503[_0x2d87cc(0x122)]||_0x2d87cc(0x139))));else return!![];}}}catch(_0x1a2a0b){return this['logger'][_0x2d87cc(0x11a)](_0x1a2a0b),!![];}}['isCardRecognitionEvent'](_0x1dde8f){var _0x46abc8=a55_0x442c7d;return _0x1dde8f[_0x46abc8(0x149)]==0x5&&_0x1dde8f[_0x46abc8(0x157)]==0x1||_0x1dde8f[_0x46abc8(0x149)]==0x5&&_0x1dde8f[_0x46abc8(0x157)]==0x9;}[a55_0x442c7d(0x153)](_0x1c3725){var _0x3c57c7=a55_0x442c7d;return _0x1c3725[_0x3c57c7(0x149)]==0x5&&_0x1c3725[_0x3c57c7(0x157)]==0x4b;}['isFaceDenyEvent'](_0x4ab6f4){return _0x4ab6f4['event_type']==0x5&&_0x4ab6f4['event_subtype']==0x4c;}};exports[a55_0x442c7d(0x125)]=HikvisionService,exports[a55_0x442c7d(0x125)]=HikvisionService=HikvisionService_1=__decorate([(0x0,common_1[a55_0x442c7d(0x129)])(),__metadata(a55_0x442c7d(0x11c),[axios_1[a55_0x442c7d(0x123)],bepass_service_1['BepassService']])],HikvisionService);