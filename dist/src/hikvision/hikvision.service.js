'use strict';var a55_0x22e461=a55_0x3221;(function(_0x1c1368,_0x52627b){var _0x21f5e2=a55_0x3221,_0x75358a=_0x1c1368();while(!![]){try{var _0x4f7966=-parseInt(_0x21f5e2(0xa2))/0x1+parseInt(_0x21f5e2(0xb3))/0x2*(parseInt(_0x21f5e2(0x97))/0x3)+parseInt(_0x21f5e2(0xa3))/0x4*(-parseInt(_0x21f5e2(0xa8))/0x5)+-parseInt(_0x21f5e2(0xce))/0x6+parseInt(_0x21f5e2(0xb1))/0x7*(parseInt(_0x21f5e2(0xb8))/0x8)+-parseInt(_0x21f5e2(0x9c))/0x9+parseInt(_0x21f5e2(0xcf))/0xa*(parseInt(_0x21f5e2(0xd4))/0xb);if(_0x4f7966===_0x52627b)break;else _0x75358a['push'](_0x75358a['shift']());}catch(_0x36fe94){_0x75358a['push'](_0x75358a['shift']());}}}(a55_0x428d,0x3ae68));var __decorate=this&&this['__decorate']||function(_0x5c337e,_0xe4d666,_0x5ce111,_0x115af0){var _0x1212c1=a55_0x3221,_0x52c0bb=arguments['length'],_0x388aff=_0x52c0bb<0x3?_0xe4d666:_0x115af0===null?_0x115af0=Object[_0x1212c1(0xc5)](_0xe4d666,_0x5ce111):_0x115af0,_0x25b9a0;if(typeof Reflect==='object'&&typeof Reflect[_0x1212c1(0x9d)]===_0x1212c1(0xaf))_0x388aff=Reflect['decorate'](_0x5c337e,_0xe4d666,_0x5ce111,_0x115af0);else{for(var _0x177134=_0x5c337e['length']-0x1;_0x177134>=0x0;_0x177134--)if(_0x25b9a0=_0x5c337e[_0x177134])_0x388aff=(_0x52c0bb<0x3?_0x25b9a0(_0x388aff):_0x52c0bb>0x3?_0x25b9a0(_0xe4d666,_0x5ce111,_0x388aff):_0x25b9a0(_0xe4d666,_0x5ce111))||_0x388aff;}return _0x52c0bb>0x3&&_0x388aff&&Object[_0x1212c1(0xca)](_0xe4d666,_0x5ce111,_0x388aff),_0x388aff;},__metadata=this&&this[a55_0x22e461(0xba)]||function(_0x1d85d6,_0x4772ed){var _0x537634=a55_0x22e461;if(typeof Reflect===_0x537634(0x9f)&&typeof Reflect[_0x537634(0xa4)]===_0x537634(0xaf))return Reflect[_0x537634(0xa4)](_0x1d85d6,_0x4772ed);},HikvisionService_1;function a55_0x3221(_0x16480e,_0x35eef2){var _0x428ddf=a55_0x428d();return a55_0x3221=function(_0x322140,_0x4a0496){_0x322140=_0x322140-0x94;var _0x300e00=_0x428ddf[_0x322140];return _0x300e00;},a55_0x3221(_0x16480e,_0x35eef2);}Object[a55_0x22e461(0xca)](exports,'__esModule',{'value':!![]}),exports['HikvisionService']=void 0x0;function a55_0x428d(){var _0x5715e2=['HttpService','lastValueFrom','cardNoTerminal','notFound','employeeNoString','Logger','subEventType','parseEvent','\x20face\x20recognized\x20user\x20type:\x20','serialNo','getOwnPropertyDescriptor','cardOrFace','BEPASS_ACCESS_CONTROL_ENABLED','get','@nestjs/axios','defineProperty','currentVerifyMode','face','http://127.0.0.1/supervisor.php?codigo=invalid','1440336nrYNvd','9080GpkvoR','card\x20event','accessCode','cardNo','parse','5599YynAYO','HikvisionService','event_type','isFaceDenyEvent','http://localhost/supervisor.php?codigo=','10212fyWKgK','design:paramtypes','bepassService','@nestjs/common','event_subtype','1051722ChXsnE','decorate','watch','object','card','XXXX','22578VtvnwT','104156maIPFd','metadata','httpService','userType','websocketMessage','25YktBZL','deviceName','isCardRecognitionEvent','access\x20denied','logger','name','event_log','function','BepassService','43673zqXoMj','abcd1234','166XZdJGt','env','true','isFaceRecognitionEvent','log','8USmLjH','AccessControllerEvent','__metadata'];a55_0x428d=function(){return _0x5715e2;};return a55_0x428d();}const common_1=require(a55_0x22e461(0x9a)),process=require('process'),rxjs_1=require('rxjs'),axios_1=require(a55_0x22e461(0xc9)),bepass_service_1=require('../bepass/bepass.service');let HikvisionService=HikvisionService_1=class HikvisionService{constructor(_0x3d6a1b,_0x2e95c1){var _0x5a22bb=a55_0x22e461;this[_0x5a22bb(0xa5)]=_0x3d6a1b,this[_0x5a22bb(0x99)]=_0x2e95c1,this[_0x5a22bb(0xac)]=new common_1[(_0x5a22bb(0xc0))](HikvisionService_1[_0x5a22bb(0xad)]),this['HIKI_CREDENCIALS']={'user':'admin','password':_0x5a22bb(0xb2)};}[a55_0x22e461(0xc2)](_0xefa0c3){var _0x503ef9=a55_0x22e461;return{'device':_0xefa0c3['AccessControllerEvent'][_0x503ef9(0xa9)],'terminalIP':_0xefa0c3['ipAddress'],'userIdFormatted':_0xefa0c3[_0x503ef9(0xb9)][_0x503ef9(0xbf)],'event_type':_0xefa0c3[_0x503ef9(0xb9)]['majorEventType'],'name':_0xefa0c3[_0x503ef9(0xb9)]['name']||_0x503ef9(0xbe),'event_subtype':_0xefa0c3[_0x503ef9(0xb9)][_0x503ef9(0xc1)],'userType':_0xefa0c3[_0x503ef9(0xb9)][_0x503ef9(0xa6)],'verification_mode':_0xefa0c3[_0x503ef9(0xb9)][_0x503ef9(0xcb)],'accessCode':_0xefa0c3[_0x503ef9(0xb9)][_0x503ef9(0xbf)]||![],'serialNo':_0xefa0c3[_0x503ef9(0xb9)][_0x503ef9(0xc4)],'dateTime':_0xefa0c3['dateTime'],'direction':'','cardOrFace':'','multiclubesStatus':'','multiclubesMessage':'','statusDescription':'','cardNo':_0xefa0c3[_0x503ef9(0xb9)]['cardNo']};}async[a55_0x22e461(0x9e)](_0x646778){var _0x477fc1=a55_0x22e461;try{this[_0x477fc1(0xac)]['debug'](JSON['parse'](_0x646778[_0x477fc1(0xae)]));let _0x17a5cd=this[_0x477fc1(0xc2)](JSON[_0x477fc1(0xd3)](_0x646778['event_log']));if(this[_0x477fc1(0xb6)](_0x17a5cd))return this['logger']['log'](_0x477fc1(0xc3)+_0x17a5cd['userType']),_0x17a5cd[_0x477fc1(0xc6)]=_0x477fc1(0xcc),_0x17a5cd['accessCode']?await this[_0x477fc1(0x99)]['websocketMessage']({'message':{'hash':_0x17a5cd[_0x477fc1(0xd1)]}}):await(0x0,rxjs_1[_0x477fc1(0xbc)])(this[_0x477fc1(0xa5)][_0x477fc1(0xc8)](_0x477fc1(0x96)+(_0x17a5cd['accessCode']||'XXXX'))),!![];else{if(this[_0x477fc1(0x95)](_0x17a5cd)){if(process[_0x477fc1(0xb4)][_0x477fc1(0xc7)]===_0x477fc1(0xb5))return console[_0x477fc1(0xb7)](_0x477fc1(0xab)),await(0x0,rxjs_1[_0x477fc1(0xbc)])(this[_0x477fc1(0xa5)][_0x477fc1(0xc8)](_0x477fc1(0xcd))),!![];}else{if(this['isCardRecognitionEvent'](_0x17a5cd))this[_0x477fc1(0xac)][_0x477fc1(0xb7)](_0x477fc1(0xd0)),this[_0x477fc1(0xac)]['debug'](_0x17a5cd[_0x477fc1(0xd2)]),_0x17a5cd['cardOrFace']=_0x17a5cd['event_subtype']===0x9?_0x477fc1(0xbd):_0x477fc1(0xa0),_0x17a5cd[_0x477fc1(0xd2)]?await this[_0x477fc1(0x99)][_0x477fc1(0xa7)]({'message':{'hash':_0x17a5cd[_0x477fc1(0xd2)]}}):await(0x0,rxjs_1[_0x477fc1(0xbc)])(this[_0x477fc1(0xa5)][_0x477fc1(0xc8)](_0x477fc1(0x96)+(_0x17a5cd[_0x477fc1(0xd2)]||_0x477fc1(0xa1))));else return!![];}}}catch(_0x2b95f4){return this[_0x477fc1(0xac)]['error'](_0x2b95f4),!![];}}[a55_0x22e461(0xaa)](_0xee507c){var _0x80d8ef=a55_0x22e461;return _0xee507c[_0x80d8ef(0x94)]==0x5&&_0xee507c[_0x80d8ef(0x9b)]==0x1||_0xee507c['event_type']==0x5&&_0xee507c[_0x80d8ef(0x9b)]==0x9;}[a55_0x22e461(0xb6)](_0x45cb45){var _0x5cbdd5=a55_0x22e461;return _0x45cb45[_0x5cbdd5(0x94)]==0x5&&_0x45cb45['event_subtype']==0x4b;}['isFaceDenyEvent'](_0xd28edf){return _0xd28edf['event_type']==0x5&&_0xd28edf['event_subtype']==0x4c;}};exports[a55_0x22e461(0xd5)]=HikvisionService,exports[a55_0x22e461(0xd5)]=HikvisionService=HikvisionService_1=__decorate([(0x0,common_1['Injectable'])(),__metadata(a55_0x22e461(0x98),[axios_1[a55_0x22e461(0xbb)],bepass_service_1[a55_0x22e461(0xb0)]])],HikvisionService);