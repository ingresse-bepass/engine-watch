'use strict';const a13_0x4f8fba=a13_0x30f9;function a13_0x1cee(){const _0x459006=['main','getLocalIpAddresses','status','includes','393176asquuB','http://10.17.50.2:3002/tickets/checkin','CardName','ledDoubleEntrance','checkinOnBeka','sendToTurnStile','lastValueFrom','warn','verbose','Data','Events','__esModule','name','Method:\x20','function','object','id:\x20','networkInterfaces','getOwnPropertyDescriptor','get','--myboundary\x0d\x0a','HttpService','IntelbrasService','ledAllowEntrance','718235FpJmat','success','image/jpeg','stringify','330571zzMqvM','printDataReceived','wrong_gate','62288ZHZcOx','__decorate','369nOnwpE','219MXCvdR','http://127.0.0.1:5000/doublentry','http://127.0.0.1:5000/allowed','httpService','parseData','blocked','__metadata','log','decorate','Logger','toString','eth0','join','error','24344XOeJEN','Interface\x20\x27','logger','IPv4','validateOnBeka','CardNo','slice','\x27\x20not\x20found.','No\x20IPv4\x20address\x20found\x20for\x20interface\x20\x27','2212962TPDpHq','7ySGJqu','post','family','....validation\x20on\x20beka...','http://10.17.50.2:3002/tickets/document','http://127.0.0.1:5000/denied','Content-Type','rxjs','Method','defineProperty','error\x20on\x20beka....\x20o.O','internal','beka\x20response\x20status\x20','metadata','UserID','http://127.0.0.1:5000/ticket','beka\x20response\x20','data','split','12815980jiBCnl'];a13_0x1cee=function(){return _0x459006;};return a13_0x1cee();}(function(_0x5f4f0b,_0xc43578){const _0x33fe27=a13_0x30f9,_0x52fde3=_0x5f4f0b();while(!![]){try{const _0x3c748e=parseInt(_0x33fe27(0x128))/0x1+-parseInt(_0x33fe27(0x15e))/0x2+parseInt(_0x33fe27(0x12e))/0x3*(-parseInt(_0x33fe27(0x12b))/0x4)+-parseInt(_0x33fe27(0x124))/0x5+-parseInt(_0x33fe27(0x145))/0x6*(-parseInt(_0x33fe27(0x146))/0x7)+-parseInt(_0x33fe27(0x13c))/0x8*(-parseInt(_0x33fe27(0x12d))/0x9)+parseInt(_0x33fe27(0x159))/0xa;if(_0x3c748e===_0xc43578)break;else _0x52fde3['push'](_0x52fde3['shift']());}catch(_0x17539f){_0x52fde3['push'](_0x52fde3['shift']());}}}(a13_0x1cee,0x99820));var __decorate=this&&this[a13_0x4f8fba(0x12c)]||function(_0x3a91d9,_0x457fd0,_0x3bc430,_0x514b92){const _0x408f0d=a13_0x4f8fba;var _0x1cf107=arguments['length'],_0x2e73b2=_0x1cf107<0x3?_0x457fd0:_0x514b92===null?_0x514b92=Object[_0x408f0d(0x170)](_0x457fd0,_0x3bc430):_0x514b92,_0x35a3a6;if(typeof Reflect===_0x408f0d(0x16d)&&typeof Reflect['decorate']===_0x408f0d(0x16c))_0x2e73b2=Reflect[_0x408f0d(0x136)](_0x3a91d9,_0x457fd0,_0x3bc430,_0x514b92);else{for(var _0x484571=_0x3a91d9['length']-0x1;_0x484571>=0x0;_0x484571--)if(_0x35a3a6=_0x3a91d9[_0x484571])_0x2e73b2=(_0x1cf107<0x3?_0x35a3a6(_0x2e73b2):_0x1cf107>0x3?_0x35a3a6(_0x457fd0,_0x3bc430,_0x2e73b2):_0x35a3a6(_0x457fd0,_0x3bc430))||_0x2e73b2;}return _0x1cf107>0x3&&_0x2e73b2&&Object[_0x408f0d(0x14f)](_0x457fd0,_0x3bc430,_0x2e73b2),_0x2e73b2;},__metadata=this&&this[a13_0x4f8fba(0x134)]||function(_0x548480,_0xf303e1){const _0x5db7c1=a13_0x4f8fba;if(typeof Reflect===_0x5db7c1(0x16d)&&typeof Reflect[_0x5db7c1(0x153)]==='function')return Reflect[_0x5db7c1(0x153)](_0x548480,_0xf303e1);},IntelbrasService_1;Object[a13_0x4f8fba(0x14f)](exports,a13_0x4f8fba(0x169),{'value':!![]}),exports['IntelbrasService']=void 0x0;const common_1=require('@nestjs/common'),rxjs_1=require(a13_0x4f8fba(0x14d)),axios_1=require('@nestjs/axios'),os_1=require('os');function a13_0x30f9(_0x5b69af,_0x5585e9){const _0x1cee19=a13_0x1cee();return a13_0x30f9=function(_0x30f93f,_0x2346e0){_0x30f93f=_0x30f93f-0x124;let _0x296bb8=_0x1cee19[_0x30f93f];return _0x296bb8;},a13_0x30f9(_0x5b69af,_0x5585e9);}let IntelbrasService=IntelbrasService_1=class IntelbrasService{constructor(_0x14f41a){const _0x4c4f9c=a13_0x4f8fba;this[_0x4c4f9c(0x131)]=_0x14f41a,this[_0x4c4f9c(0x13e)]=new common_1[(_0x4c4f9c(0x137))](IntelbrasService_1[_0x4c4f9c(0x16a)]);}[a13_0x4f8fba(0x132)](_0x1b6176){const _0x10c388=a13_0x4f8fba,_0x1df194=_0x1b6176[_0x10c388(0x138)]()[_0x10c388(0x158)](_0x10c388(0x172));if(_0x1df194){let _0x5b9a42;for(const _0x432b0e of _0x1df194){if(_0x432b0e[_0x10c388(0x15d)](_0x10c388(0x14c))){const _0x5cf610=_0x432b0e[_0x10c388(0x158)]('\x0d\x0a'),_0x202513=_0x5cf610[0x0][_0x10c388(0x158)](':\x20')[0x1];if(_0x202513==_0x10c388(0x126)){}else _0x5b9a42=_0x5cf610[_0x10c388(0x142)](0x3,-0x1)[_0x10c388(0x13a)]('\x0d\x0a');}}return _0x5b9a42;}else return![];}[a13_0x4f8fba(0x129)](_0xcbf9f2){const _0x29e9cd=a13_0x4f8fba;var _0x3ad6be,_0x519dec,_0x4dd796,_0x29acfd;this[_0x29e9cd(0x13e)][_0x29e9cd(0x166)]('name:\x20'+((_0x3ad6be=_0xcbf9f2[_0x29e9cd(0x168)][0x0][_0x29e9cd(0x167)])===null||_0x3ad6be===void 0x0?void 0x0:_0x3ad6be[_0x29e9cd(0x160)])),this[_0x29e9cd(0x13e)][_0x29e9cd(0x166)]('card:\x20'+((_0x519dec=_0xcbf9f2['Events'][0x0]['Data'])===null||_0x519dec===void 0x0?void 0x0:_0x519dec[_0x29e9cd(0x141)])),this[_0x29e9cd(0x13e)]['verbose'](_0x29e9cd(0x16e)+((_0x4dd796=_0xcbf9f2[_0x29e9cd(0x168)][0x0][_0x29e9cd(0x167)])===null||_0x4dd796===void 0x0?void 0x0:_0x4dd796[_0x29e9cd(0x154)])),this[_0x29e9cd(0x13e)]['verbose'](_0x29e9cd(0x16b)+((_0x29acfd=_0xcbf9f2['Events'][0x0]['Data'])===null||_0x29acfd===void 0x0?void 0x0:_0x29acfd[_0x29e9cd(0x14e)]));}async['validateTicket'](_0x4fa7a7,_0x3cb4e7){const _0x17847c=a13_0x4f8fba;try{if(_0x4fa7a7){this[_0x17847c(0x13e)]['log'](_0x17847c(0x149)),this['logger'][_0x17847c(0x135)](_0x4fa7a7),this[_0x17847c(0x13e)][_0x17847c(0x135)](_0x3cb4e7),this[_0x17847c(0x13e)][_0x17847c(0x135)](this[_0x17847c(0x15b)](_0x17847c(0x139)));const _0x413a9f={'hash':_0x4fa7a7,'checkInType':_0x3cb4e7,'checkInDevice':this['getLocalIpAddresses'](_0x17847c(0x139)),'gateId':_0x17847c(0x15a)};this['logger'][_0x17847c(0x166)](_0x413a9f);const _0x40dd8b=await this[_0x17847c(0x140)](_0x413a9f);switch(_0x40dd8b[_0x17847c(0x15c)]){case _0x17847c(0x125):this['sendToTurnStile']('allowed'),this[_0x17847c(0x162)](_0x413a9f);break;case'double_entry':this[_0x17847c(0x163)]('double_entrance');break;case _0x17847c(0x12a):this[_0x17847c(0x163)]('wrong_gate');break;default:this[_0x17847c(0x163)](_0x17847c(0x133));}}else return![];}catch(_0x593922){this['logger'][_0x17847c(0x13b)](_0x17847c(0x150)),this[_0x17847c(0x13e)][_0x17847c(0x13b)](JSON[_0x17847c(0x127)](_0x593922));}}async[a13_0x4f8fba(0x140)](_0x221ae7){const _0x2d7bee=a13_0x4f8fba;this['logger']['verbose'](_0x221ae7);const _0xc53af=await(0x0,rxjs_1[_0x2d7bee(0x164)])(this[_0x2d7bee(0x131)][_0x2d7bee(0x147)](_0x2d7bee(0x14a),_0x221ae7));return this['logger'][_0x2d7bee(0x135)](_0x2d7bee(0x152)+_0xc53af[_0x2d7bee(0x15c)]),this[_0x2d7bee(0x13e)][_0x2d7bee(0x135)](_0x2d7bee(0x156)+JSON[_0x2d7bee(0x127)](_0xc53af===null||_0xc53af===void 0x0?void 0x0:_0xc53af[_0x2d7bee(0x157)])),_0xc53af===null||_0xc53af===void 0x0?void 0x0:_0xc53af[_0x2d7bee(0x157)];}async['checkinOnBeka'](_0x15cb31){const _0x200714=a13_0x4f8fba;this[_0x200714(0x13e)][_0x200714(0x166)](_0x15cb31);const _0x173e5d=await(0x0,rxjs_1[_0x200714(0x164)])(this['httpService'][_0x200714(0x147)](_0x200714(0x15f),_0x15cb31));return this[_0x200714(0x13e)]['log']('beka\x20response\x20status\x20'+_0x173e5d[_0x200714(0x15c)]),this[_0x200714(0x13e)][_0x200714(0x135)]('beka\x20response\x20'+JSON[_0x200714(0x127)](_0x173e5d===null||_0x173e5d===void 0x0?void 0x0:_0x173e5d[_0x200714(0x157)])),_0x173e5d===null||_0x173e5d===void 0x0?void 0x0:_0x173e5d[_0x200714(0x157)];}async[a13_0x4f8fba(0x163)](_0x511676){const _0x12a98c=a13_0x4f8fba,_0x4ec860={'permission':_0x511676},_0x28a93b=await(0x0,rxjs_1[_0x12a98c(0x164)])(this[_0x12a98c(0x131)]['post'](_0x12a98c(0x155),_0x4ec860));this[_0x12a98c(0x13e)][_0x12a98c(0x166)]('response\x20from\x20turnstile...\x20'+JSON[_0x12a98c(0x127)](_0x28a93b[_0x12a98c(0x157)]));}async[a13_0x4f8fba(0x161)](){const _0xb15e14=a13_0x4f8fba;try{return await(0x0,rxjs_1[_0xb15e14(0x164)])(this[_0xb15e14(0x131)][_0xb15e14(0x171)](_0xb15e14(0x12f)));}catch(_0x4521ad){return this['logger'][_0xb15e14(0x13b)](_0x4521ad),![];}}async[a13_0x4f8fba(0x175)](){const _0x18cbf5=a13_0x4f8fba;try{return await(0x0,rxjs_1['lastValueFrom'])(this[_0x18cbf5(0x131)][_0x18cbf5(0x171)](_0x18cbf5(0x130)));}catch(_0x349c14){return this[_0x18cbf5(0x13e)][_0x18cbf5(0x13b)](_0x349c14),![];}}async['ledDenyEntrance'](){const _0x5e5416=a13_0x4f8fba;try{return await(0x0,rxjs_1[_0x5e5416(0x164)])(this[_0x5e5416(0x131)]['get'](_0x5e5416(0x14b)));}catch(_0x362459){return this[_0x5e5416(0x13e)][_0x5e5416(0x13b)](_0x362459),![];}}[a13_0x4f8fba(0x15b)](_0x4806d8){const _0x4fed48=a13_0x4f8fba,_0x337cfd=os_1['default'][_0x4fed48(0x16f)](),_0x329729=_0x337cfd[_0x4806d8];if(!_0x329729)return console['warn'](_0x4fed48(0x13d)+_0x4806d8+_0x4fed48(0x143)),null;for(const _0xf4ef6 of _0x329729){if(_0xf4ef6[_0x4fed48(0x148)]===_0x4fed48(0x13f)&&!_0xf4ef6[_0x4fed48(0x151)])return _0xf4ef6['address'];}return console[_0x4fed48(0x165)](_0x4fed48(0x144)+_0x4806d8+'\x27.'),'error-ip';}};IntelbrasService=IntelbrasService_1=__decorate([(0x0,common_1['Injectable'])(),__metadata('design:paramtypes',[axios_1[a13_0x4f8fba(0x173)]])],IntelbrasService),exports[a13_0x4f8fba(0x174)]=IntelbrasService;