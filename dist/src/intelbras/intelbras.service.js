'use strict';const a13_0x5ac472=a13_0x3487;function a13_0x3487(_0x1656ce,_0x133d94){const _0x35831e=a13_0x3583();return a13_0x3487=function(_0x34879c,_0x113a20){_0x34879c=_0x34879c-0xdf;let _0x2f225a=_0x35831e[_0x34879c];return _0x2f225a;},a13_0x3487(_0x1656ce,_0x133d94);}(function(_0x5d581c,_0x4aa187){const _0x4e6635=a13_0x3487,_0x33d3be=_0x5d581c();while(!![]){try{const _0x3daffa=-parseInt(_0x4e6635(0xee))/0x1+parseInt(_0x4e6635(0xeb))/0x2+-parseInt(_0x4e6635(0x133))/0x3*(-parseInt(_0x4e6635(0x10c))/0x4)+parseInt(_0x4e6635(0x111))/0x5*(parseInt(_0x4e6635(0xf0))/0x6)+-parseInt(_0x4e6635(0x101))/0x7*(-parseInt(_0x4e6635(0x102))/0x8)+parseInt(_0x4e6635(0xec))/0x9+parseInt(_0x4e6635(0xe5))/0xa*(-parseInt(_0x4e6635(0x11f))/0xb);if(_0x3daffa===_0x4aa187)break;else _0x33d3be['push'](_0x33d3be['shift']());}catch(_0x117d28){_0x33d3be['push'](_0x33d3be['shift']());}}}(a13_0x3583,0xcf4b2));function a13_0x3583(){const _0x593ae1=['beka\x20response\x20status\x20','object','includes','IntelbrasService','image/jpeg','IPv4','104derbyG','logger','HttpService','card:\x20','address','4240nDBwPb','\x27\x20not\x20found.','http://127.0.0.1:5000/denied','ledDoubleEntrance','data','@nestjs/axios','name','__decorate','eth0','split','family','allowed','Method:\x20','Data','591283FCrbBe','name:\x20','main','metadata','wrong_gate','status','beka\x20response\x20','http://127.0.0.1:5000/allowed','post','defineProperty','Method','id:\x20','sendToTurnStile','error\x20on\x20beka....\x20o.O','toString','lastValueFrom','length','@nestjs/common','default','slice','160887ICznNk','log','error','getLocalIpAddresses','checkinOnBeka','get','Injectable','620sKwrdn','__esModule','CardName','__metadata','error-ip','ledDenyEntrance','941828IRQZjF','12668238ZDVvxs','internal','930190DXAZRS','....validation\x20on\x20beka...','2850dYkjFv','Events','validateOnBeka','response\x20from\x20turnstile...\x20','verbose','warn','Logger','http://127.0.0.1:5000/doublentry','getOwnPropertyDescriptor','stringify','function','http://127.0.0.1:5000/ticket','blocked','printDataReceived','decorate','httpService','parseData','18550ulOIFA','4336kMNvsE','CardNo','design:paramtypes','Interface\x20\x27'];a13_0x3583=function(){return _0x593ae1;};return a13_0x3583();}var __decorate=this&&this[a13_0x5ac472(0x118)]||function(_0x659228,_0x75116a,_0x74fc7d,_0x254330){const _0x4cf976=a13_0x5ac472;var _0x23864f=arguments[_0x4cf976(0x12f)],_0x3a4fdc=_0x23864f<0x3?_0x75116a:_0x254330===null?_0x254330=Object[_0x4cf976(0xf8)](_0x75116a,_0x74fc7d):_0x254330,_0x1c9d9e;if(typeof Reflect===_0x4cf976(0x107)&&typeof Reflect[_0x4cf976(0xfe)]===_0x4cf976(0xfa))_0x3a4fdc=Reflect[_0x4cf976(0xfe)](_0x659228,_0x75116a,_0x74fc7d,_0x254330);else{for(var _0x18b8dd=_0x659228[_0x4cf976(0x12f)]-0x1;_0x18b8dd>=0x0;_0x18b8dd--)if(_0x1c9d9e=_0x659228[_0x18b8dd])_0x3a4fdc=(_0x23864f<0x3?_0x1c9d9e(_0x3a4fdc):_0x23864f>0x3?_0x1c9d9e(_0x75116a,_0x74fc7d,_0x3a4fdc):_0x1c9d9e(_0x75116a,_0x74fc7d))||_0x3a4fdc;}return _0x23864f>0x3&&_0x3a4fdc&&Object['defineProperty'](_0x75116a,_0x74fc7d,_0x3a4fdc),_0x3a4fdc;},__metadata=this&&this[a13_0x5ac472(0xe8)]||function(_0x4a95ec,_0x3e833b){const _0x1a06cc=a13_0x5ac472;if(typeof Reflect===_0x1a06cc(0x107)&&typeof Reflect[_0x1a06cc(0x122)]===_0x1a06cc(0xfa))return Reflect['metadata'](_0x4a95ec,_0x3e833b);},IntelbrasService_1;Object[a13_0x5ac472(0x128)](exports,a13_0x5ac472(0xe6),{'value':!![]}),exports['IntelbrasService']=void 0x0;const common_1=require(a13_0x5ac472(0x130)),rxjs_1=require('rxjs'),axios_1=require(a13_0x5ac472(0x116)),os_1=require('os');let IntelbrasService=IntelbrasService_1=class IntelbrasService{constructor(_0xad314c){const _0x129e83=a13_0x5ac472;this[_0x129e83(0xff)]=_0xad314c,this['logger']=new common_1[(_0x129e83(0xf6))](IntelbrasService_1[_0x129e83(0x117)]);}[a13_0x5ac472(0x100)](_0x11fdd6){const _0x3ee108=a13_0x5ac472,_0x1c952d=_0x11fdd6[_0x3ee108(0x12d)]()['split']('--myboundary\x0d\x0a');if(_0x1c952d){let _0x126aac;for(const _0x3c5e55 of _0x1c952d){if(_0x3c5e55[_0x3ee108(0x108)]('Content-Type')){const _0x5370ad=_0x3c5e55[_0x3ee108(0x11a)]('\x0d\x0a'),_0x1576d6=_0x5370ad[0x0]['split'](':\x20')[0x1];if(_0x1576d6==_0x3ee108(0x10a)){}else _0x126aac=_0x5370ad[_0x3ee108(0x132)](0x3,-0x1)['join']('\x0d\x0a');}}return _0x126aac;}else return![];}[a13_0x5ac472(0xfd)](_0x54c025){const _0x4cb59b=a13_0x5ac472;var _0x4ec2d5,_0x1ff12a,_0x51eaa8,_0x1aa79d;this[_0x4cb59b(0x10d)]['verbose'](_0x4cb59b(0x120)+((_0x4ec2d5=_0x54c025[_0x4cb59b(0xf1)][0x0][_0x4cb59b(0x11e)])===null||_0x4ec2d5===void 0x0?void 0x0:_0x4ec2d5[_0x4cb59b(0xe7)])),this['logger']['verbose'](_0x4cb59b(0x10f)+((_0x1ff12a=_0x54c025[_0x4cb59b(0xf1)][0x0]['Data'])===null||_0x1ff12a===void 0x0?void 0x0:_0x1ff12a[_0x4cb59b(0x103)])),this[_0x4cb59b(0x10d)][_0x4cb59b(0xf4)](_0x4cb59b(0x12a)+((_0x51eaa8=_0x54c025[_0x4cb59b(0xf1)][0x0][_0x4cb59b(0x11e)])===null||_0x51eaa8===void 0x0?void 0x0:_0x51eaa8['UserID'])),this[_0x4cb59b(0x10d)][_0x4cb59b(0xf4)](_0x4cb59b(0x11d)+((_0x1aa79d=_0x54c025['Events'][0x0]['Data'])===null||_0x1aa79d===void 0x0?void 0x0:_0x1aa79d[_0x4cb59b(0x129)]));}async['validateTicket'](_0x601e23,_0x3b8d46){const _0x539c44=a13_0x5ac472;try{if(_0x601e23){this[_0x539c44(0x10d)]['log'](_0x539c44(0xef)),this['logger'][_0x539c44(0xdf)](_0x601e23),this['logger'][_0x539c44(0xdf)](_0x3b8d46),this[_0x539c44(0x10d)][_0x539c44(0xdf)](this[_0x539c44(0xe1)](_0x539c44(0x119)));const _0x216e72={'hash':_0x601e23,'checkInType':_0x3b8d46,'checkInDevice':this['getLocalIpAddresses']('eth0'),'gateId':_0x539c44(0x121)};this[_0x539c44(0x10d)][_0x539c44(0xf4)](_0x216e72);const _0x41c5ef=await this['validateOnBeka'](_0x216e72);switch(_0x41c5ef[_0x539c44(0x124)]){case'success':this['sendToTurnStile'](_0x539c44(0x11c)),this[_0x539c44(0xe2)](_0x216e72);break;case'double_entry':this[_0x539c44(0x12b)]('double_entrance');break;case _0x539c44(0x123):this[_0x539c44(0x12b)](_0x539c44(0x123));break;default:this[_0x539c44(0x12b)](_0x539c44(0xfc));}}else return![];}catch(_0x2d0587){this[_0x539c44(0x10d)][_0x539c44(0xe0)](_0x539c44(0x12c)),this['logger'][_0x539c44(0xe0)](JSON[_0x539c44(0xf9)](_0x2d0587));}}async[a13_0x5ac472(0xf2)](_0xabc03d){const _0x29f931=a13_0x5ac472;this[_0x29f931(0x10d)][_0x29f931(0xf4)](_0xabc03d);const _0x444d5c=await(0x0,rxjs_1[_0x29f931(0x12e)])(this[_0x29f931(0xff)][_0x29f931(0x127)]('http://10.17.50.3:3002/tickets/document',_0xabc03d));return this[_0x29f931(0x10d)][_0x29f931(0xdf)]('beka\x20response\x20status\x20'+_0x444d5c[_0x29f931(0x124)]),this[_0x29f931(0x10d)]['log'](_0x29f931(0x125)+JSON['stringify'](_0x444d5c===null||_0x444d5c===void 0x0?void 0x0:_0x444d5c['data'])),_0x444d5c===null||_0x444d5c===void 0x0?void 0x0:_0x444d5c[_0x29f931(0x115)];}async[a13_0x5ac472(0xe2)](_0x2d7f12){const _0x29b5d0=a13_0x5ac472;this[_0x29b5d0(0x10d)]['verbose'](_0x2d7f12);const _0x214c47=await(0x0,rxjs_1[_0x29b5d0(0x12e)])(this[_0x29b5d0(0xff)][_0x29b5d0(0x127)]('http://10.17.50.3:3002/tickets/checkin',_0x2d7f12));return this[_0x29b5d0(0x10d)][_0x29b5d0(0xdf)](_0x29b5d0(0x106)+_0x214c47[_0x29b5d0(0x124)]),this[_0x29b5d0(0x10d)][_0x29b5d0(0xdf)]('beka\x20response\x20'+JSON[_0x29b5d0(0xf9)](_0x214c47===null||_0x214c47===void 0x0?void 0x0:_0x214c47['data'])),_0x214c47===null||_0x214c47===void 0x0?void 0x0:_0x214c47[_0x29b5d0(0x115)];}async['sendToTurnStile'](_0x4c0a3f){const _0x941beb=a13_0x5ac472,_0x29b619={'permission':_0x4c0a3f},_0x23eba4=await(0x0,rxjs_1['lastValueFrom'])(this[_0x941beb(0xff)][_0x941beb(0x127)](_0x941beb(0xfb),_0x29b619));this['logger'][_0x941beb(0xf4)](_0x941beb(0xf3)+JSON[_0x941beb(0xf9)](_0x23eba4[_0x941beb(0x115)]));}async[a13_0x5ac472(0x114)](){const _0x28379a=a13_0x5ac472;try{return await(0x0,rxjs_1['lastValueFrom'])(this[_0x28379a(0xff)]['get'](_0x28379a(0xf7)));}catch(_0xb83b83){return this[_0x28379a(0x10d)][_0x28379a(0xe0)](_0xb83b83),![];}}async['ledAllowEntrance'](){const _0x575c97=a13_0x5ac472;try{return await(0x0,rxjs_1[_0x575c97(0x12e)])(this[_0x575c97(0xff)][_0x575c97(0xe3)](_0x575c97(0x126)));}catch(_0x158330){return this[_0x575c97(0x10d)][_0x575c97(0xe0)](_0x158330),![];}}async[a13_0x5ac472(0xea)](){const _0x5449a1=a13_0x5ac472;try{return await(0x0,rxjs_1[_0x5449a1(0x12e)])(this['httpService'][_0x5449a1(0xe3)](_0x5449a1(0x113)));}catch(_0x18ed28){return this[_0x5449a1(0x10d)][_0x5449a1(0xe0)](_0x18ed28),![];}}[a13_0x5ac472(0xe1)](_0x3cb184){const _0x2c80f9=a13_0x5ac472,_0x3c6bf8=os_1[_0x2c80f9(0x131)]['networkInterfaces'](),_0x39b7b4=_0x3c6bf8[_0x3cb184];if(!_0x39b7b4)return console[_0x2c80f9(0xf5)](_0x2c80f9(0x105)+_0x3cb184+_0x2c80f9(0x112)),null;for(const _0x20425d of _0x39b7b4){if(_0x20425d[_0x2c80f9(0x11b)]===_0x2c80f9(0x10b)&&!_0x20425d[_0x2c80f9(0xed)])return _0x20425d[_0x2c80f9(0x110)];}return console[_0x2c80f9(0xf5)]('No\x20IPv4\x20address\x20found\x20for\x20interface\x20\x27'+_0x3cb184+'\x27.'),_0x2c80f9(0xe9);}};IntelbrasService=IntelbrasService_1=__decorate([(0x0,common_1[a13_0x5ac472(0xe4)])(),__metadata(a13_0x5ac472(0x104),[axios_1[a13_0x5ac472(0x10e)]])],IntelbrasService),exports[a13_0x5ac472(0x109)]=IntelbrasService;